Summary: Should be able to prompt for a proxy password
Class: wish
Priority: medium
Difficulty: tricky
Content-type: text/plain

Currently, proxy passwords have to be stored unencrypted in the registry, or
entered manually through the setup dialogue before every session.  It should
be possible to enter them at the time the connection is set up, like other
passwords.

Each proxied connection maps to exactly one actual network connection, and
our UI may need to reflect this (no attempt to log in without password before
prompting; no retries).

I (JTN) have just checked all the proxy protocols we support (SOCKS4,
SOCKS5, HTTP), and I don't _think_ any of them support the sending of
username but no password (as opposed to an empty password).

Therefore I think this change to the proxy authentication UI should
suffice:

  [x] Attempt username/password authentication

  Username: (o) prompt  ( ) use this: [abc123   ]
  Password: (o) prompt  ( ) use this: [******   ]

and would map onto proxy types as follows:
 - telnet: if checked, %user and %pass as specified, otherwise
   zero-length
   (could be generous and only prompt for %user and %pass if they appear
   in the command string)
 - SOCKS4/4A: if checked, username as specified, otherwise zero-length
   (ignore password always)
 - SOCKS5: if checked, user/pass as specified, otherwise don't attempt
   auth
 - HTTP: if checked, user/pass as specified, otherwise don't attempt
   auth (bomb out if requested?)
 - proxy command: similar to telnet

I guess that prompting should occur by the normal mechanism of a prompt
in the terminal window, which probably means some upheaval. Probably a
good time to implement proxy-logging too.

Legacy settings: preserve whatever the current implied behaviour turns
out to be, I guess.
