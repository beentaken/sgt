Summary: Fails to run on some versions of Windows XP
Class: bug
Difficulty: fun
Priority: high
Absent-in: 0.57
Present-in: 0.58
Fixed-in: 2005-04-07 r5604
Content-type: text/x-html-body

<p>
We've had a few reports that PuTTY 0.58 utterly fails to run on some
(but not all) versions of Windows XP, with the following error
message:

<p>
<blockquote>
The application has failed to start because the
application configuration is incorrect. Reinstalling the
application may fix this problem.
</blockquote>

<p>
(Reinstalling PuTTY does not fix the problem.)

<p>
It's not clear to us precisely which variants of XP are affected.
We've only had six reports so far; the information we've seen
indicates that the problem is with older, unpatched versions of XP
(one report indicated it went away upon upgrade to SP2).

<p>
I believe this is likely due to a trim I (JTN) made to the
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sbscs/setup/application_manifests.asp">application manifests</a>;
we tested it on one XP install (SP1), but it seems not all XP installs
are born equal in this regard.

<p>
If so, it will affect the graphical utilities only (PuTTY, PuTTYtel,
PuTTYgen, and Pageant).

<p>
If you run into this, please try one of the workarounds below, which
have worked for everyone so far. If that doesn't work for you,
<em>please</em> tell us, or it will likely continue to be broken.

<p><ul>

<li>A separate manifest file. If you download the following files,
rename them as indicated, and put them in the same directory as the
relevant 0.58 executable, they should override the application
manifests and allow them to run.
<br>(Note that this is only a temporary workaround; faffing with extra
files will not be required in the long term.)
<ul>
<li><tt><a href="http://www.tartarus.org/~simon-anonsvn/viewcvs.cgi/*checkout*/putty/windows/putty.mft?rev=5604">putty.mft</a></tt>:
rename to <tt>putty.exe.manifest</tt> (or
<tt>puttytel.exe.manifest</tt>)
<li><tt><a href="http://www.tartarus.org/~simon-anonsvn/viewcvs.cgi/*checkout*/putty/windows/puttygen.mft?rev=5604">puttygen.mft</a></tt>:
rename to <tt>puttygen.exe.manifest</tt>
<li><tt><a href="http://www.tartarus.org/~simon-anonsvn/viewcvs.cgi/*checkout*/putty/windows/pageant.mft?rev=5604">pageant.mft</a></tt>:
rename to <tt>pageant.exe.manifest</tt>
</ul>

<li>A development snapshot with updated application manifests.
(Although note that we're likely to do destabilising things to the
snapshots soon, so this may not be a good long-term solution,
depending on what state they're in.)

</ul>
