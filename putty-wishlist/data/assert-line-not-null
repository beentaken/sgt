Summary: Bombs out with line==NULL in terminal.c
Class: bug
Priority: medium
Present-in: 0.56
Content-type: text/x-html-body

<p>
We receive occasional reports of PuTTY crashing out with
<code>line==NULL</code> in <code>terminal.c:lineptr()</code>.
However, we haven't been able to reproduce the problem ourselves.

<p>
In recent versions of PuTTY (0.58 and up), the error takes the form
of one or more error boxes saying "line==NULL in terminal.c" and
giving some diagnostic information, along with an exhortation to
contact us.

<p>
In versions of PuTTY before snapshot 2005-03-07, the error
is instead a failure of an assertion in <code>terminal.c</code>
that <code>line != NULL</code> (the precise line number has changed
a lot due to the extensive terminal re-engineering since 0.56).

<p>
We've had one report since we added diagnostics which indicates that
<tt>screen</tt> doesn't contain enough entries. However, we haven't
thought of a plausible mechanism for <tt>screen</tt> or
<tt>alt_screen</tt> to end up undersized.

<p>
(Possibly related, although we've no hard evidence for this:
<a href="assert-fail-newsavelines.html">`assert-fail-newsavelines'</a>
and <a href="large-clipboard-crash.html">`large-clipboard-crash'</a>.)

<ul>
<li><tt>Pine.0410290832480.79579@mozart.musicbox.net</tt>
  <br>0.56 on WinME and 2K; terminal.c:159
<li><tt>2164FF46E100024E87C4F72442B267050393955A@mail02.ad.telekom.lv</tt>
  <br>0.56 on W2KSP2; terminal.c:159
<li><tt>BB8EDCA75DA7624F9A8B446F68A56C70438A89@PKDWB06C.ad.sprint.com</tt>
  <br>0.56 on Win2K; terminal.c:159
  <br>"disable switching to alternate screen" enabled
<li><tt>f37cdb910503291851a052bd9@mail.gmail.com</tt>
  <br>with diagnostic info
</ul>

<p>
Perhaps an unrelated bug that's already been fixed:
<ul>
<li><tt>000d01c4b1c7$ca506090$4296a8c0@nadine</tt>
  <br>2004-10-14; terminal.c:662; connecting to SunOS
  <br>reportedly fixed in 2004-10-15, although since other reports
  indicate the failure is intermittent, perhaps not
</ul>
